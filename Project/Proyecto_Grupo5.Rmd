---
title: "Estudio de las preferencias de los consumidores de cine"
author: "Sección 6 - Grupo 5"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    toc: yes
    toc_float:
      collapsed: no
      smooth_scroll: no
    number_sections: yes
    theme: yeti
---

# **Introducción**  

Antes de la llegada de la pandemia, existía una gran cantidad de usuarios que asistían a las salas de cines ya que muchas veces el cine en general es visto como un buen centro de entretenimiento y sobre todo para pasarlo en familia, esto era muy significativo para la industria cinematográfica. Pero la industria del cine sufrió una crisis económica al declararse la pandemia "COVID-19" en el año 2020, las personas ya no frecuentaban en las salas de los cines debido a las restricciones sanitarias, a pesar de que actualmente se ha vuelto a la normalidad, las salas de cines siguen en una crisis económica. Es por todo lo anteriormente mencionado que el presente proyecto del curso de Estadística y Probabilidad tiene como objetivo identificar el perfil de los usuarios para la mejora de la experiencia en las salas de cine.  


### **Tema del proyecto**  

Perfil y análisis descriptivo de los usuarios que frecuentan el cine.  


### **Relevancia**  

Nuestro tema es de suma importancia, pues buscamos el mejoramiento de la experiencia en los cines mediante una encuesta que realizamos a los usuarios que residen en Lima y frecuentan a las salas de cines. Con la información obtenida podemos brindar sugerencias claves y comunicarlo a las empresas como Cineplanet, Cinemark, etc, los resultados que hemos obtenido para que logren obtener un mayor éxito en el servicio al cliente, con la finalidad de llamar mucho más la atención del público objetivo.


### **Objetivos**  

##### **General:**  

* Identificar el perfil de los usuarios que frecuentan las salas de cine para brindar mejoras en el servicio a partir de las preferencias que tienen los usuarios.  

##### **Específicos**  

- Conocer si sus usuarios están satisfechos con la experiencia de las salas de cine y/o compra de sus productos.  

- Identificar las preferencias de géneros cinematográficos en función a la edad de los usuarios.  

- Analizar los factores que pueden influir en la frecuencia de visitas al cine y en la compra de sus productos de dulcería.  

- Encontrar los patrones de consumo del público para mejorar la calidad de los servicios en cines.  


### **Contexto**  

En el presente proyecto evaluaremos una gran cantidad de datos generados en la encuesta que realizamos a personas que residen en Lima y frecuentan las salas de cine, los datos serán analizados utilizando el software RStudio que emplea el lenguaje de programación R, el cual es de mucha utilidad en estudios estadísticos y de probabilidades. Además, cuenta con muchos comandos para obtener descriptores numéricos tales como el promedio, la media, los valores máximos y mínimos obtenidos; incluso tiene la capacidad de realizar gráficos univariados y bivariados, los cuales serán de ayuda para interpretar  de una manera más fácil las variables que analizaremos *( Ver Tabla 1)*.  


# **Datos**  

### **Proceso de recolección de datos**  

La recolección de datos se hizo a través de un "Google forms"([Encuesta](https://forms.gle/sg9ARDnVLBoow58B8)). Esto fue realizado de manera grupal con la intervención de cada uno de los miembros de nuestro equipo. Durante todo el proceso, hicimos énfasis en realizar preguntas con respuestas para marcar y en las preguntas para rellenar nos aseguramos de proporcionar restricciones en los números según el rango propuesto para cada variable, para poder obtener datos relacionados con nuestro proyecto.\
Luego se hizo la difusión de la encuesta por redes sociales, siendo la más usada "WhatsApp" con la mayor cantidad de contactos residentes en Lima, pues siempre teníamos en cuenta nuestro público objetivo.  


### **Población, muestra y muestreo**  

La población en la que nos enfocamos son los **consumidores de la industria cinematográfica que asisten a las salas de cine que viven en el distrito de Lima**. La muestra con la que se trabajó está conformada por **202 personas** (observaciones) las cuales son consumidores de diversas edades y preferencias, donde nuestra unidad muestral es cada persona que suele asistir a las salas de cine en el distrito de Lima. Además, el tipo de muestreo es aleatorio simple para garantizar la representatividad de la muestra.  


### **Variables**  

Para el proyecto se tienen **17** variables, las cuales son:  


|Variable|Tipo|Descripción y restricción|
|:------------------:|:----:|:-----------:|
|Entradas|Numérica continua|Precio de la entrada del cine por persona en soles.Tiene un rango de S/.3.00 soles hasta S/.50. Número continuo positivo|
|Presupuesto|Numérica continua|Presupuesto estimado en soles para una visita al cine, incluye entradas y comidas. Número continuo positivo|
|Viaje|Numérica continua|Tiempo de viaje en minutos desde la casa del consumidor hasta el cine que suele frecuentar. Número continuo positivo|
|Edad|Numérica discreta|Edad del consumidor en años. Tiene un rango de 15 hasta 55 años. Número entero positivo|
|Frecuencia|Numérica discreta|Frecuencia de visitas al mes. Tiene un rango de 0 (casi nunca asiste al cine) hasta 30(máxima cantidad de días en un mes). Número entero positivo|
|Vistas|Numérica discreta|Número de películas que una persona ha visto más de una vez en el cine.  Tiene un rango de 0 (no repite una película) hasta 30(ha visto la misma película 30 veces). Número entero positivo|
|Calidad|Categórica ordinal|Excelente, bueno, regular, malo, pésimo|
|Satisfacción|Categórica ordinal|Excelente, bueno, regular, malo, pésimo, no compra|
|Presupuestofinal|Categórica ordinal|Sí, No, A veces|
|Distrito|Categórica nominal|Distrito de residencia del consumidor|
|Estadocupacional|Categórica nominal|Estudia, trabaja, estudia y trabaja, ninguno|
|Socio|Categórica nominal|Socio del cine|
|Cine|Categórica nominal|¿A qué cine van? (Cineplanet, Cinemark, Cinépolis, UVK, Cine Star|
|Días|Categórica nominal|Día de semana que acostumbra ir|
|Confitería|Categórica nominal|¿Suele comprar en la confitería?|
|Acompañamiento|Categórica nominal|¿Va acompañado al cine?|
|Género|Categórica nominal|Género de preferencia (drama, comedia, romance, acción, terror, suspenso, musical, ciencia ficción, fantasía, aventura)|
<center>*Tabla 1. Tabla de Variables. Elaboración propia.*</center>
 

### **Análisis exploratorio**  

Previo a la limpieza de datos debemos realizar un análisis exploratorio que consiste en examinar la estructura y componentes del *dataset*.  

**1.  Leer la data** 

```{r message=FALSE,echo=FALSE}
if (!require(readr)) {
  install.packages("readr")
  library(readr)
}
if (!require(dplyr)) {
  install.packages("dplyr")
  library(dplyr)
}
if (!require(plyr)) {
  install.packages("plyr")
  library(plyr)
}
if (! require (ggplot2)) 
{install.packages ('ggplot2')
  library(ggplot2)
  }
if (! require (multimode)) 
{install.packages ('multimode')
  library(multimode)}

```

```{r}
DD <- read_csv("Data.csv")
```


**2. Revisar la data**  

Con `ncol` y `nrow` podemos tener las dimensiones de la base de datos (filas y columnas)
```{r,echo=FALSE}
cat('Los datos presentan',nrow(DD),'observaciones y',ncol(DD),'variables.')
```
Después de utilizar el comando `ncol` nos da un resultado de 18 columnas, las cuales nos indica que poseemos 18 variables. Sin embargo, en nuestro proyecto solo haremos uso de 17 variables. Además, se debe tener $202\times18=3636$ (celdas) y todas ellas deben estar llenas.

```{r,echo=FALSE}
cat('Hay un total de',sum(!is.na(DD)),'datos y',sum(complete.cases(DD)),'observaciones completas.')
```
Utilizando `is.na` y `complete.cases` confirmamos que no se encuentran datos faltantes en nuestro dataset.

A continuación hallaremos la variable que no se usará en el estudio haciendo uso de comandos como `str` y `glimpse` que también nos permitirá ver el tipo de variable de la base de datos que asume RStudio.

```{r}
glimpse(DD)
```

```{r}
str(DD)
```

Después de ver las variables, sabemos que la primera que se toma en cuenta es la variable "Marca Temporal", que nos indica la hora que fue llenada la encuesta. Esta columna será removida en la limpieza de datos.

Utilizando el comando `summary` obtendremos un resumen general de la base de datos.

```{r}
summary(DD)
```

Observamos que los nombres de nuestras variables son muy extensos, para ello lo cambiaremos más adelante en nuestra limpieza de datos por unos nombres más cortos y comprensibles según los nombres que pusimos en nuestra tabla de datos.


**3.  Revisar el principio y final de la data**  

Es necesario ver el principio y final de la base de datos, para tener una idea de qué podría estar fallando o si todo anda con normalidad  
```{r,echo=FALSE}
head(DD) #lee las primeras filas de la base de datos
```

```{r,echo=FALSE}
tail(DD) #lee las últimas filas de la base de datos
```


### **Limpieza de datos**  

**1. Eliminando la variable "Marca Temporal"**
```{r}
DD1 <- DD %>%
  select(-"Marca temporal")
```


**2. Renombrando las variables**
```{r}
DD1 = dplyr::rename(DD1,
               Edad="Edad",
               Distrito="Distrito de residencia",
               Estadocupacional="Estado ocupacional",
               Presupuesto="Presupuesto estimado",
               Presupuestofinal = "¿Sigue su presupuesto estimado?",
               Cine ="Cine al que va usualmente",
               Socio="¿Es socio del cine al que suele asistir?",
               Dias ="Días de la semana a la que acostumbra ir al cine",
               Frecuencia = "Frecuencias de visitas al cine en un mes",
               Vistas = "Número de películas que ha visto más de una vez.",
               Genero ="Género cinematográfico de preferencia",
               Viaje = "¿Cuánto tiempo demora en ir desde su casa al cine en minutos?",
               Entradas = "Precio de las entradas del cine en soles",
               Acompañamiento ="¿Va acompañado al cine?",
               Confiteria ="¿Suele comprar en la dulcería del cine?",
               Calidad ="Calidad de los productos de la dulcería",
               Satisfacción = "Experiencia general en el cine")
```

Verificando los nombres de las variables
```{r}
names(DD1)
```


**3. Recategorizando**  

Nos aseguraremos de que las variables sean numéricas discretas, es decir, no podrán aceptar decimales.
```{r}
DD1$Edad <- as.integer(DD1$Edad)
DD1$Frecuencia <- as.integer(DD1$Frecuencia)
DD1$Vistas <- as.integer(DD1$Vistas)
DD1$Viaje <- as.integer(DD1$Viaje)
```

Transformaremos los datos categóricos a factor para que queden mejor definidas.
```{r}
DD1$Calidad <- factor(DD1$Calidad)
DD1$Presupuestofinal <- factor(DD1$Presupuestofinal)
DD1$Satisfacción <- factor(DD1$Satisfacción)
DD1$Distrito <- factor(DD1$Distrito)
DD1$Estadocupacional <- factor(DD1$Estadocupacional)
DD1$Socio <- factor(DD1$Socio)
DD1$Cine <- factor(DD1$Cine)
DD1$Dias <- factor(DD1$Dias)
DD1$Confiteria <- factor(DD1$Confiteria)
DD1$Acompañamiento <- factor(DD1$Acompañamiento)
DD1$Genero <- factor(DD1$Genero)
```

Visualizaremos que se cumplan con los comandos *"str"* y *"summary"*: 
```{r}
str(DD1)
```
```{r}
summary(DD1)
```
Después de observar el resumen del **dataset** en el summary, podemos observar que las variables numéricas se encuentran dentro del rango establecido en la *Tabla 1*. Además, luego de la limpieza de datos, todas nos servirán para obtener el perfil del consumidor de los establecimientos de cine en Lima.


**4. Calculando el tamaño efectivo de las muestras**  

Debido a que nuestras variables se encontraban dentro del rango establecido no fue necesario recurrir a comandos como  `filter`. Por esta razón el tamaño efectivo de la muestra no se alteró y son iguales para cada variable.
```{r,echo=FALSE}
cat('Tamaño efectivo de las variables:
Edad:',nrow(DD1)-sum(is.na(DD1$Edad)),'\n')
cat('Distrito:',nrow(DD1)-sum(is.na(DD1$Distrito)),'\n')
cat('Estadocupacional:',nrow(DD1)-sum(is.na(DD1$Estadocupacional)),'\n')
cat('Presupuesto:',nrow(DD1)-sum(is.na(DD1$Presupuesto)),'\n')
cat('Presupuestofinal:',nrow(DD1)-sum(is.na(DD1$Presupuestofinal)),'\n')
cat('Cine:',nrow(DD1)-sum(is.na(DD1$Cine)),'\n')
cat('Socio:',nrow(DD1)-sum(is.na(DD1$Socio)),'\n')
cat('Dias:',nrow(DD1)-sum(is.na(DD1$Dias)),'\n')
cat('Frecuencia:',nrow(DD1)-sum(is.na(DD1$Frecuencia)),'\n')
cat('Vistas:',nrow(DD1)-sum(is.na(DD1$Vistas)),'\n')
cat('Genero:',nrow(DD1)-sum(is.na(DD1$Genero)),'\n')
cat('Viaje:',nrow(DD1)-sum(is.na(DD1$Viaje)),'\n')
cat('Entradas:',nrow(DD1)-sum(is.na(DD1$Entradas)),'\n')
cat('Acompañamiento:',nrow(DD1)-sum(is.na(DD1$Acompañamiento)),'\n')
cat('Confiteria:',nrow(DD1)-sum(is.na(DD1$Confiteria)),'\n')
cat('Calidad:',nrow(DD1)-sum(is.na(DD1$Calidad)),'\n')
cat('Satisfacción:',nrow(DD1)-sum(is.na(DD1$Satisfacción)),'\n')
```
```{r,echo=FALSE}
cat('Por lo tanto la proporción de las observaciones válidas de la muestra total es de:',round((nrow(DD1)-sum(is.na(DD1)))/nrow(DD1)*100,2),'% \n') #calcula la proporción de edades válidas (no na's)
```

**5. Asegurando que las variables sean prolijas**  

Para verificar que la base de datos sea prolija, es decir, tenga una observación por fila y una variable por columna, utilizamos el comando `dim`, que nos arrojará la cantidad de observaciones las cuales deben ser 202 y la cantidad de columnas las cuales deben ser 17 de acuerdo a la cantidad de variables.
```{r,echo=FALSE}
cat('Se tienen las siguientes dimensiones en el dataset actual:',dim(DD1))
```

Ahora, aseguraremos que el dataset tenga un valor entre las intersecciones entre filas y columnas, las cuales nos debe dar un total de  3434 datos en total.
```{r,echo=FALSE}
cat('Hay un total de',sum(!is.na(DD1)),'datos en el dataset actual.')
```

Finalmente, se puede afirmar que la base de datos está limpia. Esto se debe a que ahora ya es posible realizar los gráficos necesarios para el desarrollo del estudio. Asimismo, hay coherencia en cuanto a las respuestas obtenidas. 


# **Análisis Descriptivo**

Encuestamos un total de 202 usuarios del cine que se encuentran en un rango de 15 a 55 años, acuden a cines que están en el departamento de Lima. Asimismo, la unidad muestral fue cada uno de los usuarios que cumplen con esos requisitos. Ahora, realizaremos el análisis descriptivo de las variables obtenidas considerando a la muestra mencionada.


## **Análisis Univariado**

### <span style="color:blue"> **Variable *Edad*** </span>

**Descriptores numéricos:**

- Mínimo, mediana, media y máximo
```{r,echo=FALSE}
summary(DD1$Edad)
```

**Descriptor gráfico:**

```{r,fig.align='center',echo=FALSE}
BXPLEdad <- boxplot(DD1$Edad, col = "#B4EEB4",
        horizontal = TRUE,
        main = "Gráfico de la edad de los consumidores",
        xlab = "Edad")
```
<center>*Gráfico 1. Gráfico de Edad. Elaboración propia.*</center>

```{r,echo=FALSE}
cat('Los datos atípicos son:',BXPLEdad$out, '\n')
```

```{r,echo=FALSE}
cat('El coeficiente de variación es:', round(sd(DD1$Edad)/mean(DD1$Edad)*100,2), '%\n')
cat('El coeficiente de variación es:', round(sd(DD1$Edad<32)/mean(DD1$Edad<32),2), '%\n')
```

**Análisis:**

En este caso observamos que en *promedio* la edad de los consumidores es de 22.56 años. Es decir, son  jóvenes adultos, además el *primer cuartil* nos indica que el primer 25% de los consumidores tienen o están un rango de 15-19 años. La *mediana* es 20 años y el *tercer cuartil* es 24 años, lo que indicaría que hasta el primer 75% de consumidores tienen una edad de 24 años. Todos estos descriptores numéricos nos muestran que la gran mayoría de consumidores son adolescentes y jóvenes adultos que posiblemente se deba a que tengan mayor tiempo para actividades de entretenimiento. Finalmente, sabemos que el *máximo* es 52 años y por el gráfico obtenemos que los datos atípicos van desde los 32 años para adelante, los cuales hacen que los datos sean heterogéneos ya que el coeficiente de variación resulta en un 26.44%, cifra que contrasta en exceso al coeficiente de variación cuando se retiran los datos atípicos que es de un 0.31%.


### <span style="color:blue"> **Variable *Presupuesto*** </span>

**Descriptores numéricos:**

- Mínimo, mediana, media y máximo
```{r,echo=FALSE}
summary(DD1$Presupuesto)
```

**Descriptor gráfico:**  

```{r,fig.align='center',echo=FALSE}
BXPLPresupuesto <- boxplot(DD1$Presupuesto, col = "#AEEEEE",
        horizontal = TRUE,
        main = "Gráfico del Presupuesto de un consumidor",
        xlab = "Presupuesto en soles")
```
<center>*Gráfico 2. Gráfico de Presupuesto. Elaboración propia.*</center>

```{r,echo=FALSE}
cat('Los datos atípicos son:',BXPLPresupuesto$out, '\n')
```

```{r,echo=FALSE}
cat('El coeficiente de variación es:', round(sd(DD1$Presupuesto)/mean(DD1$Presupuesto)*100,2), '%\n')
cat('El coeficiente de variación es:', round(sd(DD1$Presupuesto<90)/mean(DD1$Presupuesto<90),2), '%\n')
```

**Análisis:**

En este caso observamos que en *promedio* del presupuesto para una visita al cine es de 44.05 soles y la *mediana* es de 40 soles, lo que indica que la distribución de la variable es sesgada a la derecha. Además, a partir del *tercer cuartil*, después del 75% de los datos, hasta el valor *máximo* que es 120, se pueden apreciar en el gráfico que se presentan varios datos atípicos. Los cuales influyen en la precisión de los datos ya que tenemos un 55.56% de porcentaje en el coeficiente de variación, mientras que si no consideramos los datos atípicos, los resultados serían homogéneos con un 0.34% de coeficiente de variación. Esto puede deberse a que la gran mayoría al ser jóvenes no cuentan con mucho presupuesto y que los pocos adultos que acuden al cine cuentan con más dinero para el presupuesto en una sola salida al cine.


### <span style="color:blue"> **Variable *Cine*** </span>

**Descriptor Gráfico:**  

```{r,fig.align='center',echo=FALSE}
tabcine<-table(DD1$Cine)
barp<-barplot(tabcine,main= "Gráfico de preferencia de cine",col=c("red", "blue", "yellow", "white", "black"),xlab = "Cine", ylab = "Recurrencia", ylim=c(0,140), legend.text = c("Cinemark", "Cineplanet", "Cinépolis", "CineStar","UVK"))
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "grey")
text(barp, tabcine, tabcine, pos = 3, col = "black")
```
<center>*Gráfico 3. Gráfico de Cine. Elaboración propia.*</center>

**Análisis:**

El *Gráfico 3* nos indica que el establecimiento Cineplanet es el más concurrido, sobrepasando por más del 100% en recurrencia a comparación de los demás cines.


### <span style="color:blue"> **Variable *Días*** </span>

**Descriptor Gráfico:**  

```{r,fig.align='center',echo=FALSE}
tabdias<-table(DD1$Dias)
barp<-barplot(tabdias,main= "Gráfico de Días más concurridos",col=c("green", "orange", "yellow", "red", "blue", "white", "black"), ylab = "Número de días", ylim=c(0,80))
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "grey")
text(barp, tabdias, tabdias, pos = 3, col = "black")
```
<center>*Gráfico 4. Gráfico de Días. Elaboración propia.*</center>

**Análisis:**

En el *Gráfico 4* podemos observar que el viernes es el día más concurrido en los cines, lo que puede deberse a que es próximo al fin de semana.


### <span style="color:blue"> **Variable *Frecuencia*** </span>

**Descriptor Gráfico:**  

```{r,fig.align='center',echo=FALSE}
BXPLFrecuencia <-boxplot(DD1$Frecuencia, col = "yellow",
        horizontal = TRUE,
        main = "Gráfico de la frecuencia de visitas en el cine",
        xlab = "Número de visitas al mes")
stats <- boxplot.stats(DD1$Frecuencia)
text(stats$out, rep(1, length(stats$out)), round(stats$out, 2), pos = 3, col = "red") 
text(stats$stats, rep(1, length(stats$stats)), round(stats$stats, 2), pos = 3, col = "black") 
if (!is.null(stats$coef)) {
  text(stats$coef, 1, round(stats$coef, 2), pos = 3, col = "black", offset = 2) 
}
```
<center>*Gráfico 5. Gráfico de Frecuencia. Elaboración propia.*</center>

**Análisis:**

Para la variable Frecuencia la *mediana* es de 2 visitas al mes y según nos indica la gráfica la distribución de la variable es sesgada a la derecha ya que el grosor de la caja a la derecha de la línea negra es mayor que el grosor de la parte izquierda. Lo que se debe a que hay algunos consumidores que van constantemente al cine en el mes, siendo que la *máxima* cantidad de veces que va un consumidor es de 15 visitas por mes.


### <span style="color:blue"> **Variable *Entradas*** </span>

**Descriptores numéricos:**  

- Mínimo, mediana, media y máximo
```{r,echo=FALSE}
summary(DD1$Entradas)
```

**Descriptor Gráfico:**  

```{r,fig.align='center',echo=FALSE}
BXPLOEntrada <- boxplot(DD1$Entradas, col = "#EEAEEE",
        horizontal = TRUE,
        main = "Gráfico del precio de las entradas",
        xlab = "Precio de las entradas en soles")
```
<center>*Gráfico 6. Gráfico de Entradas. Elaboración propia.*</center>

```{r,echo=FALSE}
cat('Los datos atípicos son:',BXPLOEntrada$out, '\n')
```

```{r,echo=FALSE}
cat('El coeficiente de variación es:', round(sd(DD1$Entradas)/mean(DD1$Entradas)*100,2), '%\n')
cat('El coeficiente de variación es:', round(sd(DD1$Entradas<29)/mean(DD1$Entradas<29),2), '%\n')
```

**Análisis:**

Observamos que el *promedio* del costo de las entradas es de S/.18.15 soles y la *mediana* es de S/. 17 soles, lo que indica que la distribución de la variable es sesgada a la derecha. Además, el *primer cuartil*, el primer 25% de los datos, es de S/.14.50 soles, y el *tercer cuartil*, el primer 75% de los datos, es hasta los S/.20 soles. Podemos decir que el valor de los precios de las entradas se mantienen constantes en ese rango de precios ya que incluso el *coeficiente de variación* el cual es de 0.32%, nos indica la homogeneidad de los datos antes de considerar los valores atípicos que van desde los S/.29 soles hasta los S/.69.99 soles.


### <span style="color:blue"> **Variable *Calidad*** </span>

**Descriptor Gráfico:**  

```{r,fig.align='center',echo=FALSE}
tabcal<-table(DD1$Calidad)
barp<-barplot(tabcal,main= "Gráfico de la Calidad de la Dulcería",col=c("yellow", "blue", "green", "#C6E2FF", "black", "red"), ylab = "Número de personas", ylim=c(0,80) )
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "grey")
text(barp, tabcal, tabcal, pos = 3, col = "black")
```
<center>*Gráfico 7. Gráfico de Calidad. Elaboración propia.*</center>

**Análisis:**

El *Gráfico 7* nos indica que a la mayoría de los usuarios les parece regular la calidad de los productos en las dulcerías de los cine a cual acuden más.


### <span style="color:blue"> **Variable *Satisfacción*** </span>

**Descriptor Gráfico:**  

```{r,fig.align='center',echo=FALSE}
tabsatis<-table(DD1$Satisfacción)
barp<-barplot(tabsatis,main= "Gráfico de la Satisfacción del Cine",col=c("yellow", "blue", "red", "black", "green"),ylab = "Número de personas", ylim=c(0,120), legend.text = c("Bueno", "Excelente", "Malo","Pésimo", "Regular"))
grid(nx = NA, ny = NULL, lwd = 1, lty = 1, col = "grey")
text(barp, tabsatis, tabsatis, pos = 3, col = "black")
```
<center>*Gráfico 8. Gráfico de Satisfacción. Elaboración propia.*</center>

**Análisis:**

En el *Gráfico 8* podemos observar que en general, se sienten satisfechos con la experiencia en el cine al que acuden más, ya que son muy pocas las personas a las que le parecen los servicios del establecimiento como malos o pésimos en comparación con la cantidad de personas a quienes les parecen bueno o excelente el servicio.


## **Análisis Bivariado**

### <span style="color:blue"> **Edad vs. Presupuesto** </span>

```{r,fig.align='center',echo=FALSE}
Edad <-DD1$Edad
Presupuesto <-DD1$Presupuesto
```
```{r,fig.align='center',echo=FALSE}
pairs(Edad~Presupuesto,col="hotpink", main = "Gráfico de la Edad vs el Presupuesto en soles")
```
<center>*Gráfico 9. Gráfico de Edad vs Presupuesto. Elaboración propia.*</center>

En el gráfico se visualiza que la gran mayoría de jóvenes presentan menor presupuesto a la hora de ir al cine, mientras que algunos adultos entre los 30 y 40 años pueden gastar un poco más, sabiendo que el presupuesto abarca el costo de la entrada y costos adicionales como comida, podemos decir que muy pocas personas en el rango de edad de nuestra muestra gasta su dinero en la dulcería del cine o en la compra de otros productos adicionales.\


### <span style="color:blue"> **Acompañamiento vs. Presupuesto** </span>

```{r,fig.align='center',echo=FALSE}
ggplot(DD1, aes(x = Acompañamiento, y = Presupuesto, fill = Acompañamiento)) +
  geom_violin(alpha = 0.5) +
  geom_boxplot(width = 0.2) +
  theme(legend.position = "none", plot.title = element_text(hjust = 0.5)) +
  labs(title = "Gráfica del Acompañamiento y Presupuesto en soles")

```
<center>*Gráfico 10. Gráfico de Acompañamiento vs Presupuesto. Elaboración propia.*</center>

Del gráfico podemos sacar las siguientes conclusiones: 

- Los consumidores prefieren ir acompañados al cine.\
- La gran mayoría va acompañado al cine y por lo tanto, lleva un mayor presupuesto.\
- Los que van solos al cine presentan el rango más bajo de presupuesto.\

Según lo visto en el *Gráfico 9* podríamos decir que la gran mayoría que son los jóvenes prefieren ir acompañados al cine, mientras que los consumidores entre 40 y 50 años no suelen ir acompañados y es por esa razón que presentan el menor presupuesto que abarca solamente sus entradas al cine.  


### <span style="color:blue"> **Presupuesto vs. Presupuesto final** </span>
```{r,fig.align='center',echo=FALSE}

stripchart(DD1$Presupuesto~DD1$Presupuestofinal,pch=10,col=c("navy","red","#00CD00"),main="Presupuesto vs Presupuesto final",xlab="Presupuesto en soles")

```
<center>*Gráfico 11. Gráfico de Presupuesto vs Presupuesto final. Elaboración propia.*</center>

De la gráfica observamos que quienes suelen llevar mayor presupuesto también tienden a cumplirlo siempre o en su defecto lo cumplen muchas veces. En contraste con quienes llevan menos de S/.60 soles de presupuesto que no suelen seguir su presupuesto.\


### <span style="color:blue"> **Confitería vs. Calidad** </span>

```{r,fig.align='center',echo=FALSE}
library(ggplot2)

ggplot(DD1, aes(x = Confiteria, fill = Calidad)) +
  geom_bar() +
  labs(title = "Relación entre Confitería y Calidad", x = "Confitería", y = "Frecuencia") +
  scale_fill_manual(values = c("hotpink", "blue", "red", "yellow", "darkorange", "green")) +
  theme_bw()
```
<center>*Gráfico 12. Gráfico de Confitería vs Calidad. Elaboración propia.*</center>

En el gráfico podemos obtener las siguientes conclusiones:\

- Son muchos los usuarios que compran en la confitería del cine o que a veces compran ahí.\
- La gran mayoría que compra lo hacen porque los productos les parecen buenos o excelentes.\
- Los que compran a veces lo hacen porque la calidad del producto les parece regular.\


### <span style="color:blue"> **Cine vs. Calidad** </span>

```{r,fig.align='center',echo=FALSE}
library(ggplot2)
ggplot(DD1, aes(x = Cine, fill = Calidad)) +
  geom_bar() +
  scale_fill_manual(values = c("hotpink", "blue", "red", "yellow", "darkorange", "green")) +
  labs(title = "Relación entre Cine y Calidad", x = "Cine", y = "Frecuencia") +
  theme_bw()

```
<center>*Gráfico 12. Gráfico de Cine vs Calidad. Elaboración propia.*</center>

Después de visualizar el *Gráfico 11* el cual nos indicaba que la gran mayoría de consumidores compraban en la dulcería del cine, podemos observar en el presente gráfico que la percepción de la calidad de la confitería según cada cine es la siguiente:\

- Los consumidores de Cineplanet opinan que la calidad de los productos son buenos y/o regulares.\
- La opinión de los consumidores de productos en Cinépolis en su mayoría tiene una buena comparación entre las opiniones de pésimas y/o malas.\

### <span style="color:blue"> **Cine vs. Frecuencia** </span>

```{r,fig.align='center',echo=FALSE}
plot(DD1$Cine,DD1$Frecuencia, xlab = "", ylab = "Visitas al mes", main = "Gráfico de frecuencia de visitas por cine",col="lightsteelblue")
```
<center>*Gráfico 13. Gráfico de Cine vs Frecuencia. Elaboración propia.*</center>

Después de observar el gráfico podemos concluir que:\

- La frecuencia de visitas durante un mes son en su mayoría menores o iguales a 5 visitas por mes.\
- El cine con mayor frecuencia en un mes, sin contar los datos atípicos, sería UVK. Sin embargo, Cineplanet tiene algunos consumidores que van constantemente al cine, razón por la cual en el *Gráfico 5* se observa que es el más concurrido.\


### <span style="color:blue"> **Edad vs. Género** </span>

```{r,fig.align='center',echo=FALSE}
library(ggplot2)
ggplot(DD1, aes(x = Genero, y = Edad, color = Genero)) +
  geom_jitter(width = 0.3, height = 0, alpha = 0.7) +
  labs(title = "Relación entre Género y Edad", y = "Edad") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
<center>*Gráfico 14. Gráfico de Género vs Edad. Elaboración propia.*</center>

- La mayoría de los usuarios elige ver géneros de películas de acción y comedia ya que son los más interesantes y/o populares en los cines.\
- El género romance y el terror son los más disfrutados entre los consumidores de 15 y 35 años.\
- Pocos usuarios jóvenes eligen ver géneros de fantasía, musical y son menores a 30 años.\


### <span style="color:blue"> **Distrito vs. Satisfacción** </span>

```{r,fig.align='center',echo=FALSE}
library(ggplot2)

ggplot(DD1, aes(x = Distrito, fill = Satisfacción)) +
  geom_bar(position = "stack") +
  labs(title = "Satisfacción por Distrito", x = "Distrito", y = "Frecuencia") +
  scale_fill_manual(values = c("Bueno" = "#BCEE68", "Excelente" = "#1C86EE", "Malo" = "#FF4040", "Pésimo" = "black", "Regular" = "gold")) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
```
<center>*Gráfico 15. Gráfico de Distrito vs Satisfacción. Elaboración propia.*</center>

Según el presente gráfico podemos concluir que:\

- Los distritos más concurridos son de los distritos de Barranco, Chorrillos, Miraflores y Santiago de Surco.\
- Los cines con mejor calificación son los que se encuentran en Chorrillos y Miraflores. Miraflores obteniendo el mejor puntaje al no poseer ninguna calificación negativa.\
- Son pocos los cines que tienen baja percepción de satisfacción, siendo el de Surquillo el peor en satisfacción.\


### <span style="color:blue"> **Cine vs Socio** </span>


```{r,fig.align='center',echo=FALSE}
tabcinesocio<-table(DD1$Cine, DD1$Socio)
mosaicplot(tabcinesocio,col=c("red","blue"), main = "Gráfica del Cine vs Socios")
```
<center>*Gráfico 16. Gráfico de Cine vs Socios. Elaboración propia.*</center>

En el gráfico se observa la relación entre los cines y la cantidad de personas que son socias del cine. Donde se concluye que:\

- Cineplanet es el cine más concurrido, sin embargo, la gran mayoría no son socios.\
- Cinépolis a pesar de no ser tan concurrido, la gran mayoría que acuden a su establecimiento son socios.\
- La mayoría de personas que van a los cines de Cinemark y CineStar no son socios.\

# **Conclusiones**

En el estudio hemos analizado principalmente las preferencias de los usuarios con respecto a los diferentes cines de Lima Metropolitana para construir un perfil apropiado. Según lo anterior hemos podido diferenciar las preferencias que tienen los usuarios ante la gran variedad de cines.\
En primer lugar concluimos que la gran mayoría de consumidores están satisfechos con su experiencia en el cine, tanto en la compra de los productos como dentro de las salas de cine. Además, podemos darnos cuenta de la gran cantidad de usuarios que prefieren comprar en las dulcerías porque los productos son de buena calidad.\
En segundo lugar, los géneros preferidos entre todas las edades son los géneros de comedia y acción, mientras que los romance y terror son más disfrutados por los jóvenes.\
Finalmente, podemos concluir que los cines en el distrito de Miraflores son los más concurridos y de mayor satisfacción, y que se suele ir mayormente acompañado.  


# **Probabilidades**

#Probabilidad empírica
Se sabe que para las variables de Frecuencia y Edad hay 202 registros por cada una.

#Variable Frecuencia

```{r}
#Hallando el espacio muestral
table(DD1$Frecuencia)
```
Donde los valores de la variable Frecuencia son los siguientes:
```{r}
#Valor 0: 2
#Valor 1: 58
#Valor 2: 46
#Valor 3: 45
#Valor 4: 11
#Valor 5: 14
#Valor 6: 10
#Valor 7: 6
#Valor 8: 4
#Valor 10: 5
#Valor 15: 1
```
Entonces:

- El evento atómico asociado a 0 visitas por mes sería: "Seleccionar una persona de 25 años en una muestra de tamaño 100".



#Variable Edad
```{r}
#Hallando el espacio muestral
table(DD1$Edad)
```

# Probabilidad Empírica

En este estudio, se analizó el nivel de satisfacción de los consumidores. Para ello, se definimos eventos atómicos relacionados con estas variables y el calculo de la probabilidad empírica de cada evento.

# Definición de los Eventos Atómicos

Los eventos atómicos se definieron como la selección de un consumidor que presenta un nivel de satisfacción específico. Los cinco eventos atómicos son:

1. Evento A: Seleccionar un consumidor que tiene un nivel de satisfacción "Bueno".
2. Evento B: Seleccionar un consumidor que tiene un nivel de satisfacción "Excelente".
3. Evento C: Seleccionar un consumidor que tiene un nivel de satisfacción "Malo".
4. Evento D: Seleccionar un consumidor que tiene un nivel de satisfacción "Pésimo".
5. Evento E: Seleccionar un consumidor que tiene un nivel de satisfacción "Regular".

# Cálculo de la Función de Probabilidad

Se calculó la función de probabilidad para cada evento atómico. Esto se hizo contando el número de veces que cada evento atómico ocurre en la base de datos y dividiendo por el número total de registros. Los resultados obtenidos fueron los siguientes:

- Probabilidad del Evento A (Satisfacción "Bueno"): 112/202 = 0.55
- Probabilidad del Evento B (Satisfacción "Excelente"): 40/202 = 0.20
- Probabilidad del Evento C (Satisfacción "Malo"): 4/202 = 0.02
- Probabilidad del Evento D (Satisfacción "Pésimo"): 1/202 = 0.005
- Probabilidad del Evento E (Satisfacción "Regular"): 45/202 = 0.22

# Probabilidad condicional

# INDEPENDIENTES

## Ejemplos de eventos independientes

## Genero

Hallar la probabilidad de los diferentes generos de peliculas que prefieren los consumidores.

```{r}
table(DD2$Genero)
```

```{r}
DD1$E_Drama <- ifelse(DD1$Genero == "Drama", 1, 0)

# Calcular las probabilidades
P_A <- sum(DD1$E_Drama)
P_A
```

# Calcular las probabilidades

- Probabilidad para Acción:

18/202

- Probabilidad para Aventura:

8/202

- Probabilidad para CienciaFiccion:

9/202

- Probabilidad para Comedia:

51/202

- Probabilidad para Drama:

18/202

- Probabilidad para Fantasia:

3/202

- Probabilidad para Musical:

3/202

- Probabilidad para Romance:

32/202

- Probabilidad para Terror:

17/202

- Probabilidad para Suspenso:

11/202


# DEPENDIENTES

Variables seleccionadas:

* Frecuencia: Esta variable indica la cantidad de veces que un consumidor visita el cine en un determinado período de tiempo.
* Satisfacción: Esta variable refleja el grado de satisfacción de los consumidores con respecto a su experiencia en el cine.

# Definición de los eventos

En este estudio, se analizó la relación entre la frecuencia de visitas al cine y el nivel de satisfacción de los consumidores. Para ello, se definieron dos eventos:

- Evento A: Un consumidor visita el cine con una frecuencia alta (más de 3 veces al mes).
- Evento B: Un consumidor tiene un nivel de satisfacción excelente.

# Validación de la Independencia de los Eventos

```{r}
# Cargar la librería necesaria
library(dplyr)

# Definir los eventos
DD1$Evento_A <- ifelse(DD1$Frecuencia > 3, 1, 0)
DD1$Evento_B <- ifelse(DD1$Satisfaccion == "Excelente", 1, 0)

# Calcular las probabilidades
P_A <- sum(DD1$Evento_A) / nrow(DD1)
P_B <- sum(DD1$Evento_B) / nrow(DD1)
P_A_inter_B <- sum(DD1$Evento_A & DD1$Evento_B) / nrow(DD1)

# Verificar si los eventos son independientes
independientes <- abs(P_A_inter_B - P_A * P_B) < 1e-9

# Imprimir los resultados
print(paste("P(A) =", P_A))
print(paste("P(B) =", P_B))
print(paste("P(A ∩ B) =", P_A_inter_B))
print(paste("¿Son A y B independientes? ", independientes))
```

Se verificó la independencia de los eventos A y B. Los resultados mostraron que estos eventos no son independientes, lo que indica que existe una relación entre la frecuencia de visitas al cine y el nivel de satisfacción de los consumidores.

# Cálculo de la Probabilidad Condicional


```{r}
# Calcular la probabilidad condicional si los eventos son dependientes
if (!independientes) {
  P_A_given_B <- P_A_inter_B / P_B
  print(paste("P(A|B) =", P_A_given_B))
}
```

Se calculó la probabilidad condicional P(A|B), que representa la probabilidad de que un consumidor visite el cine con una alta frecuencia, dado que tiene un nivel de satisfacción excelente. El resultado obtenido fue P(A|B) = 0.3, lo que indica que el 30% de los consumidores con un nivel de satisfacción excelente visita el cine con alta frecuencia.

# Aplicar el Teorema de Bayes para hallar P(B|A)

```{r}
# Calcular P(B|A)
P_B_given_A <- P_A_inter_B / P_A

# Aplicar el Teorema de Bayes
P_B_given_A_Bayes <- P_B_given_A * P_B / P_A
print(paste("P(B|A) según Bayes =", P_B_given_B_Bayes))

```
El resultado de P(A|B) = 0.1845, lo que sugiere que la probabilidad de que un consumidor con un nivel de satisfacción excelente visite el cine con alta frecuencia es del 18.45%.


# Probabilidad Total

```{r}
# Calcular P(A|Bcomplemento) y P(Bcomplemento)
P_A_given_Bcomplemento <- sum(DD1$Evento_A & !DD1$Evento_B) / sum(!DD1$Evento_B)
P_Bcomplemento <- 1 - P_B

# Aplicar el Teorema de la Probabilidad Total
P_A_total <- P_A_given_B * P_B + P_A_given_Bcomplemento * P_Bcomplemento
print(paste("P(A) según el Teorema de la Probabilidad Total =", P_A_total))
```

Aplicando el Teorema de la Probabilidad Total para calcular la probabilidad total de que un consumidor visite el cine con alta frecuencia. El resultado obtenido fue P(A) = 0.2525, lo que indica que la probabilidad total de que un consumidor visite el cine con alta frecuencia es del 25.25%.

# **Anexo de gráficas**

- Tabla 1. Tabla de Variables. Elaboración propia.\
- Gráfico 1. Gráfico de Edad. Elaboración propia.\
- Gráfico 2. Gráfico de Presupuesto. Elaboración propia.\
- Gráfico 3. Gráfico de Cine. Elaboración propia.\
- Gráfico 4. Gráfico de Días. Elaboración propia.
- Gráfico 5. Gráfico de Frecuencia. Elaboración propia.
- Gráfico 6. Gráfico de Entradas. Elaboración propia.
- Gráfico 7. Gráfico de Calidad. Elaboración propia.
- Gráfico 8. Gráfico de Satisfacción. Elaboración propia.
- Gráfico 9. Gráfico de Edad vs Presupuesto. Elaboración propia.
- Gráfico 10. Gráfico de Acompañamiento vs Presupuesto. Elaboración propia.
- Gráfico 11. Gráfico de Presupuesto vs Presupuesto final. Elaboración propia.
- Gráfico 12. Gráfico de Cine vs Calidad. Elaboración propia.
- Gráfico 13. Gráfico de Cine vs Frecuencia. Elaboración propia.
- Gráfico 14. Gráfico de Género vs Edad. Elaboración propia.
- Gráfico 15. Gráfico de Distrito vs Satisfacción. Elaboración propia.
- Gráfico 16. Gráfico de Cine vs Socios. Elaboración propia.

# AVANCE 2 DE LA PG02 ORAL

## VARIABLE DISCRETA

# 1. Distribucion y éxito 

La distribución que usaremos será la distribución binomial.

Definimos el éxito como encontrar una persona que sea adolescente, es decir, alguien menor de 19 años.

# 2. Construir la variable aleatoria

***mejorar***

Definimos nuestra variable aleatoria (X) como el número de personas encuestadas que son adolescentes en el estudio con 202 personas.

# 3. Identificar parametros

- n = 202 (el número de personas en nuestro estudio realizado)
- p = P(X) (la probabilidad de éxito, es decir, la probabilidad de encontrar a un adolescente en nuestra muestra)

# 4. Construir la densidad (funcion de masa de probabilidad)

Usando la función dbinom() en R para calcular la FMP para nuestra distribución binomial. La FMP nos dará la probabilidad de que un número determinado de éxitos ocurra dado n y p.


```{r}
p_adolescente <- sum(data$Edad < 19) / nrow(data)  # calcular p
x <- 0:nrow(data)  # todos los posibles números de éxitos
fmp <- dbinom(x, size = nrow(data), prob = p_adolescente)  # calcular la FMP

plot(x, fmp, type = "h", main = "Función de Masa de Probabilidad", xlab = "Número de éxitos", ylab = "Probabilidad")
```

# 5. Validar las propiedades de la distribucion 

```{r}
n <- nrow(DD1) # tamaño de la muestra

# Esperanza E(X)
E_X <- n * p_adolescente
E_X

# Varianza V(X)
V_X <- n * p_adolescente * (1 - p_adolescente)
V_X

# Coeficiente de variación CV(X)
CV_X <- sqrt(1 - p_adolescente) / sqrt(n * p_adolescente)
CV_X
```

# 6. 

- CASO 1

Supongamos que queremos saber la probabilidad de que menos del 25% de las personas en un grupo de 200 sean adolescentes.

Esto sería P(X <= 50), que podríamos calcular de la siguiente manera en R:

```{r}
pbinom(50, size = 200, prob = p_adolescente, lower.tail = TRUE)
```

- CASO 2

En un cine se desea saber la probabilidad de que, de 100 visitantes, más del 70% sean mayores de 18 años. Considerando que en nuestra base de datos la probabilidad de encontrar personas mayores de 18 años es de 0.75.

Vamos a definir X como el número de visitantes que son mayores de 18 años. Queremos encontrar P(X > 70). Podemos calcular esto en R utilizando la función pbinom con lower.tail = FALSE para obtener la probabilidad acumulada del complemento (es decir, la probabilidad de que X sea mayor que 70).

```{r}
p_mayores_18 = 0.75 # probabilidad de que un visitante sea mayor de 18 años
n_visitantes = 100 # número de visitantes

# Calculamos la probabilidad de que más de 70 visitantes sean mayores de 18 años
pbinom(70, size = n_visitantes, prob = p_mayores_18, lower.tail = FALSE)
```


# VARIABLE ALEATORIA DISCRETA 

# 1. Distribución Poisson

Se va a modelar el número de visitas al cine de un consumidor en un mes usando una distribución Poisson. Este tipo de distribución es útil cuando nuestros datos representan el número de veces que un evento ocurre en un intervalo de tiempo o espacio fijo.

# 2. Construir la variable aleatoria

Definiendo la variable aleatoria X como el número de veces que un consumidor visita el cine en un mes.

# 3. Parámetros de la Distribución

λ (lambda). Representa la tasa promedio de ocurrencia del evento un mes.

Asumimos que λ es 3. Esto significa que en promedio, esperamos que un consumidor visite el cine 3 veces al mes.

# 4. Función de Masa de Probabilidad

  Podemos calcular la función de masa de probabilidad (fmp) para cada posible número de visitas al cine usando la función dpois().

### Definimos lambda

```{r}
lambda <- 3
```

### Creamos una secuencia de 0 a 10 (número de visitas al cine)

```{r}
x_values <- 0:10
```

### Calculamos la fmp para cada valor en la secuencia

```{r}
probabilities <- dpois(x_values, lambda)
```

# 5. Visualización de la Distribución

```{r}
barplot(probabilities, names.arg = x_values, xlab = "Número de visitas al cine", ylab = "Probabilidad", main = "Distribución de Poisson con lambda = 3")
```

# 6. Propiedades de la Distribución

# Calcular la esperanza y la varianza

```{r}
esperanza <- sum(x_values * probabilities)
varianza <- sum((x_values - esperanza)^2 * probabilities)

print(paste("Esperanza =", esperanza))
print(paste("Varianza =", varianza))
``


